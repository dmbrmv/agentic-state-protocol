{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "name": "dependency-auditors",
  "description": "MCP configuration for Python dependency security auditing and version management",
  "version": "2.0.0",

  "securityAuditors": {
    "pip-audit": {
      "language": "python",
      "command": "pip-audit",
      "detection": ["requirements.txt", "pyproject.toml", "setup.py", "Pipfile"],
      "capabilities": {
        "audit": "pip-audit",
        "auditRequirements": "pip-audit -r requirements.txt",
        "auditStrict": "pip-audit --strict",
        "fix": "pip-audit --fix",
        "auditJson": "pip-audit --format json"
      },
      "outputParsing": {
        "vulnerabilityPattern": "(\\S+)\\s+(\\S+)\\s+(\\S+)\\s+(PYSEC-\\d+-\\d+|CVE-\\d+-\\d+)",
        "fixedVersionPattern": "fix available: (\\S+)"
      },
      "databases": ["PyPI Advisory Database", "OSV"]
    },

    "safety": {
      "language": "python",
      "command": "safety",
      "detection": ["requirements.txt", "Pipfile.lock"],
      "capabilities": {
        "check": "safety check -r requirements.txt",
        "checkJson": "safety check -r requirements.txt --json",
        "checkFull": "safety check --full-report -r requirements.txt"
      },
      "outputParsing": {
        "vulnerabilityPattern": "->\\s+(\\S+)\\s+affected\\s+by"
      },
      "requiresApiKey": false
    }
  },

  "outdatedCheckers": {
    "pip": {
      "language": "python",
      "command": "pip list --outdated",
      "detection": ["requirements.txt", "pyproject.toml"],
      "capabilities": {
        "check": "pip list --outdated",
        "checkJson": "pip list --outdated --format=json"
      },
      "outputParsing": {
        "packagePattern": "(\\S+)\\s+(\\S+)\\s+(\\S+)\\s+(\\S+)"
      }
    },

    "conda": {
      "language": "python",
      "command": "conda list --revisions",
      "detection": ["environment.yml", "environment.yaml", "conda-lock.yml"],
      "capabilities": {
        "check": "conda update --all --dry-run",
        "list": "conda list",
        "export": "conda env export --no-builds"
      },
      "outputParsing": {}
    }
  },

  "licenseCheckers": {
    "pip-licenses": {
      "language": "python",
      "command": "pip-licenses",
      "capabilities": {
        "list": "pip-licenses",
        "listJson": "pip-licenses --format=json",
        "listCsv": "pip-licenses --format=csv"
      }
    }
  },

  "severityLevels": {
    "critical": {
      "level": 4,
      "action": "block",
      "description": "Remote code execution, data breach potential"
    },
    "high": {
      "level": 3,
      "action": "warn",
      "description": "Significant security impact"
    },
    "moderate": {
      "level": 2,
      "action": "info",
      "description": "Limited security impact"
    },
    "low": {
      "level": 1,
      "action": "info",
      "description": "Minimal security impact"
    }
  },

  "defaultAllowedLicenses": [
    "MIT",
    "Apache-2.0",
    "BSD-2-Clause",
    "BSD-3-Clause",
    "ISC",
    "Unlicense",
    "0BSD",
    "CC0-1.0",
    "PSF-2.0",
    "HPND"
  ],

  "reviewRequiredLicenses": [
    "GPL-2.0",
    "GPL-3.0",
    "LGPL-2.1",
    "LGPL-3.0",
    "MPL-2.0"
  ],

  "forbiddenLicenses": [
    "AGPL-3.0",
    "SSPL-1.0",
    "BUSL-1.1"
  ],

  "autoAudit": {
    "enabled": true,
    "onSessionStart": true,
    "afterDependencyChange": true,
    "beforeCommit": true,
    "scheduledInterval": null
  },

  "globalSettings": {
    "defaultTimeout": 120,
    "cacheResults": true,
    "cacheDuration": 3600,
    "failOnCritical": true,
    "failOnHigh": false,
    "reportFormat": "detailed"
  }
}
